<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="06172387-2ef5-4547-a004-3fe3b5d33b87" Author="" Category="Authentication" Priority="2" Rule_Type="Guideline" Status="" Technology="ASP.NET 3.5" title="Store Only Salted Password Digests, not Plaintext Passwords" Topic="Security" phase="Implementation" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Do&lt;/h1&gt;&lt;p&gt;Never store passwords directly in the user store.&amp;nbsp; Instead, store a salted password hash. &lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;By storing your password with hashes and salt, you help prevent an attacker that gains access to your user store from obtaining the user passwords.&amp;nbsp; If you use encryption, you have the added problem of securing the encryption key; hashes are not reversible and have no key to be compromised.&amp;nbsp; If your credential store is compromised, the salt value helps to slow an attacker who is attempting to perform a dictionary attack.&amp;nbsp; This gives you additional time to detect and react to the compromise. &lt;/p&gt;&lt;h1&gt;When&lt;/h1&gt;&lt;p&gt;All systems which need to store user passwords should store them hashed with salt. &lt;/p&gt;&lt;h1&gt;How&lt;/h1&gt;&lt;p&gt;Ideally, use a membership provider configured with hashed password.&amp;nbsp; If you must implement your own user stores, store one-way password hashes with salt.&amp;nbsp; Generate the hash from a combination of the password and a random salt value.&amp;nbsp; Use a strong hashing algorithm such as SHA256. &lt;/p&gt;&lt;h1&gt;Additional Resources&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;For more information on How to configure&amp;nbsp;hashed password&amp;nbsp;for membership providers &lt;a href="http://msdn2.microsoft.com/en-us/library/aa479048.aspx#bucupro_topic3"&gt;http://msdn2.microsoft.com/en-us/library/aa479048.aspx#bucupro_topic3&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;br&gt;&lt;hr&gt;&lt;p&gt;Adapted from Microsoft patterns &amp;amp; practices guidance. &lt;/p&gt;</content>
</guidanceItem>